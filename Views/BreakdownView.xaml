<UserControl x:Class="pokersoc_connect.Views.BreakdownView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             MinWidth="520">
  <Grid>
    <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <StackPanel Grid.Row="0" Margin="0,0,0,8">
      <StackPanel Orientation="Horizontal">
        <TextBlock Text="{Binding Title}" FontSize="20" FontWeight="Bold"/>
        <TextBlock Text="{Binding Subtitle}" FontSize="14" Margin="12,4,0,0" Foreground="Gray"/>
      </StackPanel>
      <TextBlock Text="{Binding DateTime}" FontSize="12" Margin="0,4,0,0" Foreground="Gray"
                 Visibility="{Binding HasDateTime, Converter={StaticResource BoolToVisibility}}"/>
      <TextBlock Text="{Binding AdditionalInfo}" FontSize="12" Margin="0,4,0,0" Foreground="DarkBlue"
                 Visibility="{Binding HasAdditionalInfo, Converter={StaticResource BoolToVisibility}}" 
                 TextWrapping="Wrap"/>
    </StackPanel>

    <!-- Chips turned in -->
    <TextBlock Grid.Row="1" Text="Chips turned in" FontWeight="Bold" Margin="0,6,0,6"
               Visibility="{Binding HasChips, Converter={StaticResource BoolToVisibility}}"/>
    <DataGrid Grid.Row="2" ItemsSource="{Binding ChipsRows}" AutoGenerateColumns="False"
              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
              Visibility="{Binding HasChips, Converter={StaticResource BoolToVisibility}}">
      <DataGrid.Columns>
        <DataGridTextColumn Header="Denomination" Binding="{Binding Denomination}" Width="*" />
        <DataGridTextColumn Header="Colour"       Binding="{Binding Colour}"       Width="*" />
        <DataGridTextColumn Header="Qty"          Binding="{Binding Qty}"          Width="80" />
        <DataGridTextColumn Header="Value"        Binding="{Binding Value}"        Width="120" />
      </DataGrid.Columns>
    </DataGrid>

    <!-- Cash paid/received -->
    <TextBlock Grid.Row="3" Text="{Binding CashHeader}" FontWeight="Bold" Margin="0,10,0,6"
               Visibility="{Binding HasCash, Converter={StaticResource BoolToVisibility}}"/>
    <DataGrid Grid.Row="4" ItemsSource="{Binding CashRows}" AutoGenerateColumns="False"
              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
              Visibility="{Binding HasCash, Converter={StaticResource BoolToVisibility}}">
      <DataGrid.Columns>
        <DataGridTextColumn Header="Denomination" Binding="{Binding Denomination}" Width="*" />
        <DataGridTextColumn Header="Qty"          Binding="{Binding Qty}"          Width="80" />
        <DataGridTextColumn Header="Value"        Binding="{Binding Value}"        Width="120" />
      </DataGrid.Columns>
    </DataGrid>

    <!-- Change given back -->
    <TextBlock Grid.Row="5" Text="{Binding ChangeHeader}" FontWeight="Bold" Margin="0,10,0,6"
               Visibility="{Binding HasChange, Converter={StaticResource BoolToVisibility}}"/>
    <DataGrid Grid.Row="6" ItemsSource="{Binding ChangeRows}" AutoGenerateColumns="False"
              CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
              Visibility="{Binding HasChange, Converter={StaticResource BoolToVisibility}}">
      <DataGrid.Columns>
        <DataGridTextColumn Header="Denomination" Binding="{Binding Denomination}" Width="*" />
        <DataGridTextColumn Header="Qty"          Binding="{Binding Qty}"          Width="80" />
        <DataGridTextColumn Header="Value"        Binding="{Binding Value}"        Width="120" />
      </DataGrid.Columns>
    </DataGrid>

    <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
      <TextBlock Text="{Binding GrandTotal}" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,12,0"/>
      <Button x:Name="DeleteButton" Content="ðŸ—‘ï¸ Delete" Width="100" Click="Delete_Click" Background="OrangeRed" 
              Foreground="White" FontWeight="Bold" Margin="0,0,10,0" Visibility="Collapsed"/>
      <Button Content="Back" Width="120" Click="Back_Click" Background="LightCoral"/>
    </StackPanel>
    </Grid>

    <!-- PASSWORD CONFIRMATION OVERLAY -->
    <Grid x:Name="PasswordPanel" Visibility="Collapsed" Background="#CC000000">
      <Border Background="White" CornerRadius="10" Padding="30" 
              HorizontalAlignment="Center" VerticalAlignment="Center"
              MinWidth="320">
        <StackPanel>
          <TextBlock Text="ðŸ”" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
          <TextBlock Text="Admin Password Required" FontSize="20" FontWeight="Bold" 
                     HorizontalAlignment="Center" Margin="0,0,0,10"/>
          
          <!-- Password Display -->
          <Border Background="#F0F0F0" BorderBrush="Gray" BorderThickness="1" 
                  CornerRadius="5" Padding="15,10" Margin="0,0,0,10">
            <TextBlock x:Name="PasswordDisplay" Text="****" FontSize="28" FontWeight="Bold" 
                       HorizontalAlignment="Center" FontFamily="Consolas"/>
          </Border>
          
          <TextBlock x:Name="PasswordErrorText" Text="Incorrect password" Foreground="Red" 
                     FontSize="12" HorizontalAlignment="Center" Margin="0,0,0,10" Visibility="Collapsed"/>
          
          <!-- Numeric Keypad -->
          <Grid Width="240" HorizontalAlignment="Center">
            <Grid.RowDefinitions>
              <RowDefinition Height="60"/>
              <RowDefinition Height="60"/>
              <RowDefinition Height="60"/>
              <RowDefinition Height="60"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Row="0" Grid.Column="0" Content="1" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="1"/>
            <Button Grid.Row="0" Grid.Column="1" Content="2" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="2"/>
            <Button Grid.Row="0" Grid.Column="2" Content="3" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="3"/>
            
            <Button Grid.Row="1" Grid.Column="0" Content="4" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="4"/>
            <Button Grid.Row="1" Grid.Column="1" Content="5" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="5"/>
            <Button Grid.Row="1" Grid.Column="2" Content="6" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="6"/>
            
            <Button Grid.Row="2" Grid.Column="0" Content="7" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="7"/>
            <Button Grid.Row="2" Grid.Column="1" Content="8" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="8"/>
            <Button Grid.Row="2" Grid.Column="2" Content="9" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="9"/>
            
            <Button Grid.Row="3" Grid.Column="0" Content="âŒ«" FontSize="24" FontWeight="Bold" Margin="2" Click="KeypadBackspace_Click" Background="LightCoral"/>
            <Button Grid.Row="3" Grid.Column="1" Content="0" FontSize="24" FontWeight="Bold" Margin="2" Click="Keypad_Click" Tag="0"/>
            <Button Grid.Row="3" Grid.Column="2" Content="C" FontSize="24" FontWeight="Bold" Margin="2" Click="KeypadClear_Click" Background="Orange"/>
          </Grid>
          
          <!-- Action Buttons -->
          <Grid Margin="0,15,0,0">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0" Content="Cancel" Margin="0,0,5,0" Click="PasswordCancel_Click"
                    Padding="15,12" Background="LightGray" FontSize="14"/>
            
            <Button Grid.Column="1" Content="Confirm" Margin="5,0,0,0" Click="PasswordConfirm_Click"
                    Padding="15,12" Background="OrangeRed" Foreground="White" FontWeight="Bold" FontSize="14"/>
          </Grid>
        </StackPanel>
      </Border>
    </Grid>
  </Grid>
</UserControl>
